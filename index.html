<!DOCTYPE html>
<html>
<head>
    <title> JSG </title>
    <meta charset="utf-8">

    <link href="css/style.css" rel="stylesheet" type="text/css">
    <link href="lib/jquery-ui-1.11.4.custom/jquery-ui.min.css" rel="stylesheet" type="text/css">

    <script src="lib/jquery-1.11.1.min.js" defer></script>
    <script src="lib/jquery-ui-1.11.4.custom/jquery-ui.min.js" defer></script>
    <script src="lib/createjs-2015.05.21.min.js" defer></script>

    <script src="js/jsg/util/extend.js" defer></script>
    <script src="js/jsg/util/scale.js" defer></script>
    <script src="js/jsg/util/math-utility.js" defer></script>
    <script src="js/jsg/util/type-utility.js" defer></script>
    <script src="js/jsg/util/painter.js" defer></script>
    <script src="js/jsg/util/random-access-array.js" defer></script>

    <script src="js/jsg/config/private/physics.js" defer></script>
    <script src="js/jsg/config/private/scan-codes.js" defer></script>
    <script src="js/jsg/config/private/globals.js" defer></script>
    <script src="js/jsg/config/public/controls.js" defer></script>
    <script src="js/jsg/config/public/config.js" defer></script>

    <script src="js/jsg/objects/base-object.js" defer></script>
    <script src="js/jsg/objects/positioned-object.js" defer></script>
    <script src="js/jsg/objects/shaped-object.js" defer></script>
    <script src="js/jsg/objects/moving-object.js" defer></script>
    <script src="js/jsg/objects/circle-object.js" defer></script>
    <script src="js/jsg/objects/square-object.js" defer></script>

    <script src="js/jsg/objects/weapons/bullets/bullet.js" defer></script>
    <script src="js/jsg/objects/weapons/bullets/explosive-bullet.js" defer></script>
    <script src="js/jsg/objects/weapons/bullets/accelerating-bullet.js" defer></script>
    <script src="js/jsg/objects/weapons/bullets/machine-gun-bullet.js" defer></script>
    <script src="js/jsg/objects/weapons/bullets/rocket.js" defer></script>
    <script src="js/jsg/objects/weapons/bullets/explosive-rocket.js" defer></script>
    <script src="js/jsg/objects/weapons/bullets/fraction.js" defer></script>
    <script src="js/jsg/objects/weapons/bullets/mine-delivery.js" defer></script>
    <script src="js/jsg/objects/weapons/bullets/mine.js" defer></script>

    <script src="js/jsg/objects/weapons/chargers/charger.js" defer></script>

    <script src="js/jsg/objects/weapons/weapon.js" defer></script>
    <script src="js/jsg/objects/weapons/automatic-weapon.js" defer></script>
    <script src="js/jsg/objects/weapons/composite-weapon.js" defer></script>
    <script src="js/jsg/objects/weapons/grandfathers-gun.js" defer></script>
    <script src="js/jsg/objects/weapons/automatic-gun.js" defer></script>
    <script src="js/jsg/objects/weapons/machine-gun.js" defer></script>
    <script src="js/jsg/objects/weapons/rocket-launcher.js" defer></script>
    <script src="js/jsg/objects/weapons/tank-gun.js" defer></script>
    <script src="js/jsg/objects/weapons/mortar.js" defer></script>

    <script src="js/jsg/objects/units/unit.js" defer></script>
    <script src="js/jsg/objects/units/circle-unit.js" defer></script>
    <script src="js/jsg/objects/units/square-unit.js" defer></script>
    <script src="js/jsg/objects/units/recruit.js" defer></script>
    <script src="js/jsg/objects/units/foot-soldier.js" defer></script>
    <script src="js/jsg/objects/units/machine-gunner.js" defer></script>
    <script src="js/jsg/objects/units/guy-with-panzerschreck.js" defer></script>
    <script src="js/jsg/objects/units/tank.js" defer></script>
    <script src="js/jsg/objects/units/destroyer.js" defer></script>
    <script src="js/jsg/objects/units/player.js" defer></script>

    <script src="js/jsg/objects/effects/effect.js" defer></script>
    <script src="js/jsg/objects/effects/bullet-reflect-effect.js" defer></script>
    <script src="js/jsg/objects/effects/wind-effect.js" defer></script>

    <script src="js/jsg/cursor.js" defer></script>
    <script src="js/jsg/control/control.js" defer></script>
    <script src="js/jsg/control/default-control.js" defer></script>

    <script src="js/jsg/level-storage.js" defer></script>
    <script src="js/jsg/level-resolver.js" defer></script>
    <script src="js/jsg/enemy-factory.js" defer></script>
    <script src="js/jsg/ai.js" defer></script>
    <script src="js/jsg/game-context.js" defer></script>
    <script src="js/jsg/game-engine.js" defer></script>
    <script src="js/jsg/player-panel.js" defer></script>
    <script src="js/jsg/canvas.js" defer></script>

    <script src="js/jsg/levels/empty.js" defer></script>
    <script src="js/jsg/levels/simple.js" defer></script>
    <script src="js/jsg/levels/defence.js" defer></script>
</head>

<body onload="onLoad();">

    <div id="player-panel">
        <div class="hp-panel">
            <div class="hp"></div>
        </div>
        <div class="kills-panel">0</div>
    </div>

    <canvas id="canvas" height="900" width="1600"></canvas>

    <script>

        function resizeCanvas() {
            CANVAS.setAndValidateSize({
                width: window.innerWidth,
                height: window.innerHeight - parseInt(getComputedStyle(document.getElementById("player-panel"), '').height),
                canvasElem: document.getElementById("canvas")
            });
        }

        function onLoad() {
            resizeCanvas();

            window.onresize = function() {
                location.reload();
            };

            var dialog = $("<div/>", {id: "choose-level-dialog", title: "Choose your level"});
            for (var level in LevelStorage.getAll()) {
                if (LevelStorage.getAll().hasOwnProperty(level)) {
                    var button = $("<button/>", {class: "choose-level-button", style: "margin: 10px"}).html(level).attr("data-level", level);
                    dialog.append(button);
                }
            }
            $('body').append(dialog);


            $("#choose-level-dialog").dialog({
                resizable: false,
                width: 600,
                height: 400,
                modal: true
            });


            $(function() {
                $(".choose-level-button").button().click(function(e) {
                    e.preventDefault();
                    $("#choose-level-dialog").dialog("close");
                    var level = $(e.target).parent().data("level");
                    startGame(level);
                });
            });
        }

        function startGame(level) {
            window._ = new GameContext();

            var gameEngine = GameEngine();
            gameEngine.chooseLevel(level);
            gameEngine.start();

            PlayerPanel().initHandlers();
        }

    </script>

</body>
</html>