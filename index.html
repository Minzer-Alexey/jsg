<!DOCTYPE html>
<html>
<head>
    <title> JSG </title>
    <meta charset="utf-8">

    <link href="assets/stylesheets/style.css" rel="stylesheet" type="text/css">

    <script src="vendor/jquery-2.1.4.min.js" defer></script>
    <script src="vendor/easeljs-0.8.2.min.js" defer></script>
    <script src="vendor/soundjs-0.6.2.min.js" defer></script>

    <script src="lib/meta.js" defer></script>
    <script src="lib/request.js" defer></script>
    <script src="lib/random-access-array.js" defer></script>

    <script src="assets/js/jsg/util/math-utility.js" defer></script>
    <script src="assets/js/jsg/util/painter.js" defer></script>

    <script src="assets/js/jsg/config/private/physics.js" defer></script>
    <script src="assets/js/jsg/config/private/scan-codes.js" defer></script>
    <script src="assets/js/jsg/config/private/globals.js" defer></script>
    <script src="assets/js/jsg/config/public/controls.js" defer></script>
    <script src="assets/js/jsg/config/public/config.js" defer></script>

    <script src="assets/js/jsg/objects/base-object.js" defer></script>
    <script src="assets/js/jsg/objects/positioned-object.js" defer></script>
    <script src="assets/js/jsg/objects/shaped-object.js" defer></script>
    <script src="assets/js/jsg/objects/moving-object.js" defer></script>
    <script src="assets/js/jsg/objects/circle-object.js" defer></script>
    <script src="assets/js/jsg/objects/square-object.js" defer></script>

    <script src="assets/js/jsg/objects/weapons/bullets/bullet.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/bullets/explosive-bullet.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/bullets/accelerating-bullet.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/bullets/machine-gun-bullet.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/bullets/rocket.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/bullets/explosive-rocket.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/bullets/fraction.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/bullets/mine-delivery.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/bullets/mine.js" defer></script>

    <script src="assets/js/jsg/objects/weapons/chargers/charger.js" defer></script>

    <script src="assets/js/jsg/objects/weapons/weapon-set.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/weapon.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/automatic-weapon.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/composite-weapon.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/grandfathers-gun.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/automatic-gun.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/machine-gun.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/rocket-launcher.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/tank-gun.js" defer></script>
    <script src="assets/js/jsg/objects/weapons/mortar.js" defer></script>

    <script src="assets/js/jsg/objects/units/unit.js" defer></script>
    <script src="assets/js/jsg/objects/units/circle-unit.js" defer></script>
    <script src="assets/js/jsg/objects/units/square-unit.js" defer></script>
    <script src="assets/js/jsg/objects/units/tommy.js" defer></script>
    <script src="assets/js/jsg/objects/units/recruit.js" defer></script>
    <script src="assets/js/jsg/objects/units/foot-soldier.js" defer></script>
    <script src="assets/js/jsg/objects/units/machine-gunner.js" defer></script>
    <script src="assets/js/jsg/objects/units/guy-with-panzerschreck.js" defer></script>
    <script src="assets/js/jsg/objects/units/tank.js" defer></script>
    <script src="assets/js/jsg/objects/units/destroyer.js" defer></script>
    <script src="assets/js/jsg/objects/units/default-hero.js" defer></script>
    <script src="assets/js/jsg/objects/units/default-hero-2.js" defer></script>
    <script src="assets/js/jsg/objects/units/factories/unit-factory.js" defer></script>
    <script src="assets/js/jsg/objects/units/factories/enemy-factory.js" defer></script>

    <script src="assets/js/jsg/objects/effects/effect.js" defer></script>
    <script src="assets/js/jsg/objects/effects/bullet-reflect-effect.js" defer></script>
    <script src="assets/js/jsg/objects/effects/wind-effect.js" defer></script>

    <script src="assets/js/jsg/control/cursor.js" defer></script>
    <script src="assets/js/jsg/control/control-interface.js" defer></script>
    <script src="assets/js/jsg/control/control.js" defer></script>
    <script src="assets/js/jsg/control/mouse-based-control.js" defer></script>
    <script src="assets/js/jsg/control/universal-control.js" defer></script>
    <script src="assets/js/jsg/control/multi-control.js" defer></script>

    <script src="assets/js/jsg/ai/fake-ai.js" defer></script>
    <script src="assets/js/jsg/ai/default-ai.js" defer></script>

    <script src="assets/js/jsg/game-context.js" defer></script>
    <script src="assets/js/jsg/game.js" defer></script>

    <script src="assets/js/jsg/sound/sound.js" defer></script>
    <script src="assets/js/jsg/sound/sound-manager.js" defer></script>

    <script src="assets/js/jsg/levels/level-storage.js" defer></script>
    <script src="assets/js/jsg/levels/level-resolver.js" defer></script>
    <script src="assets/js/jsg/levels/definitions/level-definition.js" defer></script>
    <script src="assets/js/jsg/levels/definitions/level-definition-1.js" defer></script>
    <script src="assets/js/jsg/levels/definitions/level-definition-2.js" defer></script>
    <script src="assets/js/jsg/levels/definitions/level-definition-3.js" defer></script>

    <script src="assets/js/widgets/progress-bar.js" defer></script>
    <script src="assets/js/widgets/player-panel.js" defer></script>
    <script src="assets/js/widgets/player-panel-holder.js" defer></script>
    <script src="assets/js/widgets/canvas.js" defer></script>
    <script src="assets/js/widgets/menu.js" defer></script>
</head>

<body onload="onLoad();">
    <script>

        function onLoad() {
            var levelId = Request.getParam('levelId', 1);
            var playerCount = Math.min(Request.getParam('playerCount', 1), 2);

            PlayerPanelHolder.initialize({
                playerCount: playerCount
            }).render({
                $parent: $(document.body)
            });

            Canvas.initialize({
                width: $(document.body).width(),
                height: $(document.body).height() - PlayerPanelHolder.getHeight()
            }).render({
                $parent: $(document.body)
            });

            LevelStorage.initialize();

            Menu.initialize().render();
            Menu.hide();

            window.gctx = new GameContext();

            var game = Game();
            game.chooseLevel({
                levelId: levelId,
                playerCount: playerCount
            });

            PlayerPanelHolder.bindToPlayers();

            document.addEventListener("keydown", function (e) {
                if (e.keyCode === CONTROLS.COMMON.MENU) {
                    if (game.isPaused()) {
                        game.resume();
                        Menu.hide();
                    } else {
                        game.pause();
                        Menu.show();
                    }
                }
            });

            game.start();
        }

    </script>

</body>
</html>